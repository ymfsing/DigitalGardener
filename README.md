# publish-org-roam-ui

This action generates a static site for [org-roam-ui](https://github.com/org-roam/org-roam-ui) from [org-roam](https://www.orgroam.com/) files managed on GitHub.

It also allows deployment to GitHub Pages.
(See https://ikoamu.github.io/publish-org-roam-ui/)

By using this, you can easily publish your org-roam as a digital garden ðŸŒ±

## How to Use

First, please manage the .org files in `org-roam-directory` and the db file in org-roam using git.

```lisp
(setq org-roam-directory "/path/to/org-roam-dir")
(setq org-roam-db-location "/path/to/org-roam-dir/<org-roam-filename>.db")
```

```bash
cd /path/to/org-roam-dir/
git init
```

Then, a static org-roam-ui site is easily generated for the artifact by creating a workflow like the following.

```yml
name: Generate static org-roam-ui page
on:
  push:
    branches:
      - main
jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - name: Generate org-roam-ui page
        uses: ikoamu/publish-org-roam-ui@main
        with:
          org-roam-db-filename: <org-roam-filename>.db
```

<img width="669" alt="generated artifact" src="https://github.com/ikoamu/publish-org-roam-ui/assets/38206334/fdc9f133-c97c-4d3b-b328-3a1d86560e83">

Deploy to GitHub Pages by setting `deploy-to-pages` to true.
And sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages.

Under the repositories _Settings > GitHub Pages_ select _Deply from Action_.

```yml
permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - name: Generate org-roam-ui page
        uses: ikoamu/publish-org-roam-ui@main
        with:
          org-roam-db-filename: <org-roam-filename>.db
          deploy-to-pages: true
```

### Show Image

You can create an `img` directory directly under the repository and display image files stored there.

```org
[[./img/test.png]]
```

### Store org files in subdirectory

Set `org-roam-directory` to store org files in a subdirectory instead of directly under the repository.

```yml
jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - name: Generate org-roam-ui page
        uses: ikoamu/publish-org-roam-ui@main
        with:
          org-roam-directory: org-files
          org-roam-db-filename: org-roam.db
```

```
YourRepository
â”œâ”€â”€ .github/workflows
â”œâ”€â”€ org-files
â”‚   â”œâ”€â”€ img
â”‚   â”‚   â”œâ”€â”€ img1.png
â”‚   â”‚   â””â”€â”€ img2.png
â”‚   â”œâ”€â”€ org-roam.db
â”‚   â”œâ”€â”€ roam1.org
â”‚   â”œâ”€â”€ roam2.org
â”‚   â””â”€â”€ ãƒ»ãƒ»ãƒ»
â”œâ”€â”€ README.org
â””â”€â”€ ãƒ»ãƒ»ãƒ»
```

### Setting site tile

You can change the title of the site by specifying `site-tile`. (The default is ORUI)

```yml
jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - name: Generate org-roam-ui page
        uses: ikoamu/publish-org-roam-ui@main
        with:
          org-roam-db-filename: <org-roam-filename>.db
          site-title: my org-roam!
```

### Default section open

Sections can be kept closed during initial display.

```yml
jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - name: Generate org-roam-ui page
        uses: ikoamu/publish-org-roam-ui@main
        with:
          org-roam-db-filename: <org-roam-filename>.db
          default-section-open: false
```

## Customized org-roam-ui

Sites generated by publish-org-roam-ui have additional features implemented that are not in the original org-roam-ui.

### Code highlighting

Sites generated by publish-org-roam will have code blocks highlighted.

<img width="840" alt="code highlighting screenshot" src="https://github.com/ikoamu/publish-org-roam-ui/assets/38206334/446d2575-8079-473f-a886-be2b2bec03be">

### Search feature

Search by title, tags, or content and instantly open a node.

<img width="533" alt="search screenshot" src="https://github.com/ikoamu/publish-org-roam-ui/assets/38206334/26f20ce8-1dbf-4377-bee2-fa14da7de105">

### Support `#+ATTR_HTML` keyword in images

By writing the #+ATTR_HTML keyword for an image, it will be set as HTML attributes for the `<img>` tag.

```org
#+ATTR_HTML: :alt org-mode-unicorn :width 280px :align right
[[./img/org-mode-unicorn.svg]]
```

<img width="533" alt="HTML attributes example screenshot" src="https://github.com/ikoamu/publish-org-roam-ui/assets/38206334/75c32431-15c7-4fad-a019-039a3a2c6e4e">

## Local Build

If you don't want to upload org files to the repository, you can obtain the same site as generated by GitHub Actions by running the site generation script locally.

```bash
git clone git@github.com:ikoamu/publish-org-roam-ui.git
cd publish-org-roam-ui
./local.sh /path/to/org-roam-dir <org-roam-filename>.db
```
